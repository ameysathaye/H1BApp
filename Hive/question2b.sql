insert into table niit_h1b.question2b select split(worksite,'[,]')[1] as state,count(case_status) as cnt,year from niit_h1b.h1b_final where year='2011' and case_status='CERTIFIED' group by split(worksite,'[,]')[1],year,case_status order by cnt desc limit 5;
insert into table niit_h1b.question2b select split(worksite,'[,]')[1] as state,count(case_status) as cnt,year from niit_h1b.h1b_final where year='2012' and case_status='CERTIFIED' group by split(worksite,'[,]')[1],year,case_status order by cnt desc limit 5;
insert into table niit_h1b.question2b select split(worksite,'[,]')[1] as state,count(case_status) as cnt,year from niit_h1b.h1b_final where year='2013' and case_status='CERTIFIED' group by split(worksite,'[,]')[1],year,case_status order by cnt desc limit 5;
insert into table niit_h1b.question2b select split(worksite,'[,]')[1] as state,count(case_status) as cnt,year from niit_h1b.h1b_final where year='2014' and case_status='CERTIFIED' group by split(worksite,'[,]')[1],year,case_status order by cnt desc limit 5;
insert into table niit_h1b.question2b select split(worksite,'[,]')[1] as state,count(case_status) as cnt,year from niit_h1b.h1b_final where year='2015' and case_status='CERTIFIED' group by split(worksite,'[,]')[1],year,case_status order by cnt desc limit 5;
insert into table niit_h1b.question2b select split(worksite,'[,]')[1] as state,count(case_status) as cnt,year from niit_h1b.h1b_final where year='2016' and case_status='CERTIFIED' group by split(worksite,'[,]')[1],year,case_status order by cnt desc limit 5;
